## 新手上路

### 前置准备：

##### 1. 确认版本系统：

MaaTOT 仅支持 Windows 10 和 11。

##### 2. 确认运行环境：

请确认你的电脑安装了 VCRedist x64 和 .NET 8 运行库。

点击 [vc_redist.x64](https://aka.ms/vs/17/release/vc_redist.x64.exe) 下载安装 VCRedist x64；

点击 [dotnet-sdk-8.0.5-win-x64.exe](https://download.visualstudio.microsoft.com/download/pr/ba3a1364-27d8-472e-a33b-5ce0937728aa/6f9495e5a587406c85af6f93b1c89295/dotnet-sdk-8.0.404-win-x64.exe) 下载安装.NET 8 。

##### 3. 确认模拟器支持：

参考 [模拟器支持情况](./常见问题.md#模拟器支持情况) 下载模拟器，推荐使用 `MuMu 模拟器 12`。

##### 4. 修改模拟器分辨率：

模拟器分辨率应为 `16:9` 比例，最低分辨率为 `1280 * 720`，更高不限。

##### 5. 在模拟器上安装未定事件簿：

支持官服和B服。

##### 6. 启动未定事件簿并登录账号：

只需要登录一次，除非登录失效或者你希望切换账号。

##### 7. 下载正确的版本：

在最新版本地址 <https://github.com/Coxwtwo/MaaTOT/releases> 下载对应平台的压缩包并解压。

> 大多数情况下选择 MaaTOT-win-x86_64-vXXX.zip，除非你非常确定自己的电脑是 arm 架构。

##### 8. 确认解压完整：

不要直接打开软件！请解压后再运行，请勿将压缩包解压到有中文的目录下，也不要解压到如 `C:\`、`C:\Program Files\` 等需要 UAC 权限的路径。

### 开始使用：

#### 图形化界面

> 如果你不了解命令行和图形化界面，那就选图形化界面。

   1. 双击打开 `MFAAvalonia.exe`。

   2. 设置连接设备。查看右上角 `连接` 区域，程序会自动检测正在运行的模拟器，你也可以选择手动输入 `adb.exe` 的完整路径。

   3. 选择游戏客户端类型。查看左上角 `资源类型` 区域设置游戏客户端类型，程序会自动选择官服，你可以手动选择官服或B服。

   4. 选择需要执行的任务。
      - 点击任务前的方框勾选任务。
      - 按住并上下拖动任务进行排序。
      - 点击任务末尾的齿轮对任务选项进行设置。
      - 右键点击任务可以删除任务。
      - 点击任务列表右上角加号可以添加任务。

   5. ~~启动！~~ 初次使用可能出现资源读取问题，建议设置好游戏客户端类型和任务列表后重启一次软件再开始任务。

> - 后续使用无需再次进行连接设备设置，除非需要连接的设备（模拟器）不存在。
> - 后续使用无需再次选择资源类型（游戏客户端类型）和需要执行的任务，当然你随时可以进行更改。
> - 关于手动填写 [adb路径](./常见问题.md#手动填写-adb-路径)

 **[功能介绍](./任务介绍.md)** 说明了部分功能的注意事项。

使用中遇到问题请查看 [常见问题](./常见问题.md) 。

#### 命令行

##### 1. 启动软件

双击打开 `MaaPiCli.exe`。

##### 2. 设置连接设备

程序会自动检测正在运行的模拟器，你也可以选择手动输入 `adb.exe` 的完整路径。

```plaintext
Welcome to use Maa Project Interface CLI!
MaaFramework: v4.0.0

Version: v0.0.1

### Select ADB ###

        1. Auto detect
        2. Manual input

Please input [1-2]:
```

`1. Auto detect` 为自动检测，`2. Manual input` 为手动输入，通常输入 `1` 后回车。

选择自动检测后，通常显示为：

```plaintext
Finding device...

## Select Device ##

        1. MuMuPlayer12
                C:/Program Files/Netease/MuMuPlayer-12.0/shell/adb.exe
                127.0.0.1:16384

Please input [1-1]:
```

这里显示一条选项`1. MuMuPlayer12`，输入 `1` 后回车。

> 手动输入请查看[填写adb路径](./常见问题.md#手动填写-adb-路径)，将得到的adb路径输入后回车。

##### 3. 选择客户端类型

```plaintext
### Select resource ###

        1. 官服
        2. B 服

Please input [1-2]:
```

这里根据游戏客户端类型进行选择，与 `启动游戏` 和 `退出游戏`功能有关。官服输入 `1` 后回车即可。

#####  4. 设置任务列表

```plaintext
### Add task ###

        1. 启动游戏
        2. 领取邮件
        3. 领取友谊徽章
        4. 资源申请
        5. 案例解析
        6. 领取酬谢
        7. 好感度
        8. 逸梦
        9. 专属甜心
        10. 外勤委托
        11. 刷思绪残影
        12. 刷角色材料
        13. 刷印象材料
        14. 进修副本
        15. 领取任务奖励
        16. 领取绮思奖励
        17. 退出游戏

Please input multiple [1-15]:
```

查看软件显示的总菜单，根据需求选择任务。

>  - 以空格分隔，例如 `1 2 3 10 11` 和 `2 3 14 11 10`，序号的顺序代表着执行顺序
>  - 序号可重复，例如 `1 2 3 14 11 10 14`

后面会按你设置的顺序显示每个任务的相关选项进行详细设置。

例如，选择 `10. 外勤委托` 后显示：

```plaintext
## Input option of "外勤区域" for "外勤委托" ##

        1. 滨河区
        2. 锦兰区
        3. 长滩区
        4. 嘉南区

Please input [1-4]:
```

#####  5. 开始执行任务

完成配置后，软件会显示你设置的配置详情。

```plaintext
### Current configuration ###

Controller:

        默认方式 ADB
                C:/Program Files/Netease/MuMuPlayer-12.0/shell/adb.exe
                127.0.0.1:16384

Resource:

        官服

Tasks:

        - 领取邮件
        - 领取友谊徽章
        - 进修副本
                - 进修关卡: 会展顾问（未名币）
                - 复盘次数: 1次
                - 使用能量饮料: Yes
                - 能量饮料类型: 30体力饮料
        - 刷思绪残影
                - 异常关卡思绪残影: 锋芒褪尽01-04
                - 复盘次数: 1次
                - 使用能量饮料: Yes
                - 能量饮料类型: 30体力饮料
        - 外勤委托
                - 外勤区域: 嘉南区
                - 使用能量饮料: Yes
                - 能量饮料类型: 30体力饮料

### Select action ###

        1. Switch controller
        2. Switch resource
        3. Add task
        4. Move task
        5. Delete task
        6. Run tasks
        7. Exit

Please input [1-7]:
```

确认配置正确后再输入 `6` 后回车，软件开始运行任务。

##### 进阶使用

- 在命令行中添加 `-d` 参数运行即可跳过交互直接运行任务，如 `./MaaPiCli.exe -d` 你可以使用 Windows 中的定时任务设置每日自动启动。
